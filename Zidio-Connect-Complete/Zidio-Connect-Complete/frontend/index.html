<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Zidio Connect – Demo</title>
  <style>body{font-family:Arial,Helvetica,sans-serif;background:#0b1220;color:#e6eef8;margin:0}header{background:#10203a;padding:16px}main{max-width:900px;margin:24px auto;padding:0 16px}input,button,select{padding:8px;border-radius:6px;border:1px solid #24303b;background:#071021;color:#e6eef8}button{cursor:pointer} .card{background:#071428;padding:16px;border-radius:10px;margin:12px 0}</style>
</head>
<body>
<header><h2 style="margin:0">Zidio Connect – Demo Frontend</h2></header>
<main>
  <div class="card" id="auth">
    <h3>Login</h3>
    <div><input id="email" placeholder="email" value="student@zidio.in"> <input id="password" placeholder="password" value="student123"> <button onclick="login()">Login</button></div>
    <p id="who"></p>
  </div>
  <div class="card hidden" id="jobs">
    <h3>Jobs</h3>
    <div id="job-list"></div>
  </div>
  <div class="card hidden" id="recruiter">
    <h3>Post Job</h3>
    <div><input id="title" placeholder="Title"><input id="company" placeholder="Company"><input id="location" placeholder="Location"><select id="type"><option>Internship</option><option>Job</option></select></div>
    <div style="margin-top:8px"><input id="description" placeholder="Description" style="width:60%"><button onclick="postJob()">Create</button></div>
  </div>
</main>
<script>
const API = 'http://localhost:8080/api';
let user = null;
async function login(){
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;
  const res = await fetch(API+'/auth/login', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({email,password})});
  const data = await res.json();
  if(res.ok){ user = data; document.getElementById('who').innerText = 'Logged in as '+data.fullName+' ('+data.role+')'; document.getElementById('jobs').classList.remove('hidden'); loadJobs(); if(data.role==='RECRUITER') document.getElementById('recruiter').classList.remove('hidden'); }
  else alert(data.error || 'Login failed');
}
async function loadJobs(){
  const res = await fetch(API+'/jobs'); const jobs = await res.json();
  const box = document.getElementById('job-list'); box.innerHTML='';
  jobs.forEach(j => {
    const div = document.createElement('div'); div.style.margin='8px 0'; div.style.padding='8px'; div.style.border='1px solid #24303b'; div.innerHTML = '<b>'+j.title+'</b> · '+j.company+' · '+j.location+' · '+j.type+'<br>'+j.description + (user && user.role==='STUDENT' ? '<br><button onclick="apply('+j.id+')">Apply</button>' : '');
    box.appendChild(div);
  });
}
async function postJob(){
  const body = { title: v('title'), company: v('company'), location: v('location'), type: v('type'), description: v('description') };
  const res = await fetch(API+'/jobs',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(body)});
  if(res.ok){ alert('Created'); loadJobs(); } else alert('Failed');
}
async function apply(jobId){
  const res = await fetch(API+'/applications/apply',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId:user.userId, jobId:jobId})});
  if(res.ok) alert('Applied'); else alert('Failed');
}
function v(id){ return document.getElementById(id).value; }
</script>
</body>
</html>
